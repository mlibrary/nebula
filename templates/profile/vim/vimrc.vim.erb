" Managed by puppet (nebula/profile/base/vimrc.vim.erb)

" All system-wide defaults are set in $VIMRUNTIME/debian.vim (usually just
" /usr/share/vim/vimcurrent/debian.vim) and sourced by the call to :runtime
" you can find below.  If you wish to change any of those settings, you should
" do it in this file (/etc/vim/vimrc), since debian.vim will be overwritten
" everytime an upgrade of the vim packages is performed.  It is recommended to
" make changes after sourcing debian.vim since it alters the value of the
" 'compatible' option.

" This line should not be removed as it ensures that various options are
" properly set to work with the Vim-related packages available in Debian.
runtime! debian.vim

" Remove ancient vi compatibility
set nocompatible

" Color
syntax enable
set background=dark

" Load rules based on filetype
filetype plugin indent on

" Search
" disable vim-specific search regex by inserting \v
nnoremap / /\v
vnoremap / /\v
set ignorecase	" Do case insensitive matching
set smartcase		" Unless we mix cases
set gdefault    " global search by default
set incsearch		" Incremental search
set hls         " highlight search as we type
set showmatch   " Show all matches at once

" Improve usability
set showcmd		  " Show (partial) command in status line.
set showmatch		" Show matching brackets.
set autowrite		" Automatically save before commands like :next and :make
set hidden      " Hide buffers when they are abandoned
" set mouse=a		" Enable mouse usage (all modes)
set mouse=

" Disable sounds
set noerrorbells                " shhh
set novisualbell                " shhh
set tm=500

" Smart indent when entering insert mode on empty lines
function! IndentWithI()
  if len(getline('.')) == 0
    return "\"_cc"
  else
    return "i"
  endif
endfunction
nnoremap <expr> i IndentWithI()

" Highlight and remove trailing whitespace
autocmd BufEnter * EnableStripWhitespaceOnSave
highlight ExtraWhitespace ctermbg=darkgreen guibg=darkgreen

" tabs
set expandtab                   " use spaces
set smarttab                    " be smort
set shiftwidth=2                " 2 spaces
set tabstop=2                   " 2 spaces!
set softtabstop=2               " 2 spaces!!!!
set autoindent                  " enable automatic indentation
set smartindent                 " does the right thing

" Disable backups that just clutter git
set nobackup
set nowb
set noswapfile

" Source a global configuration file if available
if filereadable("/etc/vim/vimrc.local")
  source /etc/vim/vimrc.local
endif
