# Managed by puppet (nebula/profile/haproxy/frontends.cfg.erb)

frontend www-lib-<%= @datacenter -%>-http-front
  bind <%= @floating_ip -%>:80,<%= @networking['ip'] -%>:80
  stats uri /haproxy?stats
  default_backend www-lib-<%= @datacenter -%>-http-back
  http-request set-header X-Client-IP %ci
  http-request set-header X-Forwarded-Proto http

frontend www-lib-<%= @datacenter -%>-https-front
  bind <%= @floating_ip -%>:443,<%= @networking['ip'] -%>:443 ssl crt /etc/ssl/private/www-lib
  stats uri /haproxy?stats
  default_backend www-lib-<%= @datacenter -%>-https-back
  http-response set-header "Strict-Transport-Security" "max-age=31536000"
  http-request set-header X-Client-IP %ci
  http-request set-header X-Forwarded-Proto https
